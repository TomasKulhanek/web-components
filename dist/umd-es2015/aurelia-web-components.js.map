{"version":3,"file":"aurelia-web-components.js","sources":["../../src/utilities.ts","../../src/custom-element-utilities.ts","../../src/custom-element-registry.ts"],"sourcesContent":["import { HtmlBehaviorResource } from 'aurelia-templating';\n\nexport const defineProperty = Reflect.defineProperty;\nexport const tagNameOf = (behavior: HtmlBehaviorResource) => behavior.elementName || behavior.target.name;\n\nconst sharedPropertyDescriptor = {\n  enumerable: false,\n  configurable: true,\n  get: undefined,\n  set: undefined\n} as PropertyDescriptor;\n\nexport const definePrototypeGetterSetter = <T extends object = object>(obj: T, propertyName: string, getter: () => any, setter: (val: any) => any): T => {\n  sharedPropertyDescriptor.get = getter;\n  sharedPropertyDescriptor.set = setter;\n  defineProperty(obj, propertyName, sharedPropertyDescriptor);\n  sharedPropertyDescriptor.get = sharedPropertyDescriptor.set = undefined;\n  return obj;\n};\n","import {\n  HtmlBehaviorResource,\n  BehaviorInstruction,\n  TargetInstruction,\n  ViewResources,\n  ViewSlot,\n  BoundViewFactory,\n  Controller,\n  View,\n  ViewCompiler\n} from 'aurelia-templating';\n\nimport {\n  Binding,\n  Scope,\n  InternalPropertyObserver\n} from 'aurelia-binding';\n\nimport {\n  Container\n} from 'aurelia-dependency-injection';\n\nimport {\n  DOM\n} from 'aurelia-pal';\n\nimport {\n  IGetterFunction\n} from './interface';\n\nimport {\n  definePrototypeGetterSetter,\n  defineProperty\n} from './utilities';\n\nconst emptyArray = Object.freeze([]) as any[];\n\nexport const createWebComponentClassFromBehavior = (\n  container: Container,\n  behavior: HtmlBehaviorResource,\n  viewResources: ViewResources,\n  compiler: ViewCompiler\n) => {\n\n  const CustomElementClass = class extends HTMLElement {\n\n    /**@internal */\n    _children: View[];\n    /**@internal */\n    _bindings: Binding[];\n    /**@internal */\n    au: { controller: Controller; };\n    /**@internal */\n    initialized: boolean;\n\n    constructor() {\n      super();\n      this.initialized = false;\n    }\n\n    auInit(): void {\n      if (this.initialized) {\n        return;\n      }\n\n      this.initialized = true;\n\n      const behaviorInstruction = BehaviorInstruction.element(this, behavior);\n      const attributes = this.attributes;\n      const children = this._children = [];\n      const bindings = this._bindings = [];\n\n      behavior.processAttributes(compiler, viewResources, this, attributes, behaviorInstruction);\n\n      for (let i = 0, ii = attributes.length; i < ii; ++i) {\n        const attr = attributes[i];\n        behaviorInstruction.attributes[attr.name] = attr.value;\n      }\n\n      behavior.compile(compiler, viewResources, this, behaviorInstruction, this.parentNode);\n\n      const targetInstruction = TargetInstruction.normal(\n        0,\n        0,\n        [behavior.target],\n        [behaviorInstruction],\n        /*no expression*/emptyArray,\n        behaviorInstruction\n      );\n\n      const childContainer = createElementContainer(\n        container,\n        this,\n        targetInstruction,\n        children,\n        behaviorInstruction.partReplacements,\n        viewResources\n      );\n\n      const controller = behavior.create(childContainer, behaviorInstruction, this, bindings);\n      controller.created(null);\n    }\n\n    connectedCallback(): void {\n      this.auInit();\n      let scope = { bindingContext: this, overrideContext: {} } as Scope;\n      this.au.controller.bind(scope);\n      this._bindings.forEach(x => x.bind(scope));\n      this._children.forEach(x => x.bind(scope.bindingContext, scope.overrideContext, true));\n\n      this.au.controller.attached();\n      this._children.forEach(x => x.attached());\n    }\n\n    disconnectedCallback(): void {\n      this.au.controller.detached();\n      this._children.forEach(x => x.detached());\n\n      this.au.controller.unbind();\n      this._bindings.forEach(x => x.unbind());\n      this._children.forEach(x => x.unbind());\n    }\n\n    attributeChangedCallback(attrName: string, oldValue: string, newValue: string): void {\n      this.auInit();\n      const bindable = behavior.attributes[attrName];\n      if (bindable !== undefined) {\n        this.au.controller.viewModel[bindable.name] = newValue;\n      }\n    }\n  };\n\n  const CustomElementViewModelClass = behavior.target;\n  const proto = CustomElementClass.prototype;\n  const observedAttributes: string[] = [];\n\n  behavior.properties.forEach(bindableProperty => {\n\n    const getterFn = function () {\n      return this.au.controller.viewModel[bindableProperty.name];\n    } as IGetterFunction;\n\n    getterFn.getObserver = function(obj: any) {\n      return getObserver(container, behavior, obj.au.controller.viewModel, bindableProperty.name);\n    };\n\n    definePrototypeGetterSetter(\n      proto,\n      bindableProperty.name,\n      getterFn,\n      function (value: unknown) {\n        this.au.controller.viewModel[bindableProperty.name] = value;\n      }\n    );\n\n    observedAttributes.push(bindableProperty.attribute);\n  });\n\n  defineProperty(CustomElementClass, 'observedAttributes', {\n    get: () => observedAttributes\n  });\n\n  // Object\n  //   .keys(CustomElementViewModelClass.prototype)\n  //   .forEach(key => {\n  //     const descriptor = Reflect.getOwnPropertyDescriptor(CustomElementViewModelClass.prototype, key);\n  //     if (typeof descriptor.value === 'function') {\n  //       proto[key] = function (...args: any[]) {\n  //         return this.au.controller.viewModel[key](...args);\n  //       };\n  //     }\n  //   });\n\n  return CustomElementClass;\n};\n\nconst getObserver = (\n  container: Container,\n  behavior: HtmlBehaviorResource,\n  instance: object & { __observers__: any; },\n  name: string\n): InternalPropertyObserver => {\n  let lookup = instance.__observers__;\n\n  if (lookup === undefined) {\n    if (!behavior.isInitialized) {\n      behavior.initialize(container, instance.constructor);\n    }\n\n    lookup = behavior.observerLocator.getOrCreateObserversLookup(instance);\n    behavior._ensurePropertiesDefined(instance, lookup);\n  }\n\n  return lookup[name];\n};\n\nfunction elementContainerGet(this: Container, key: any): any {\n  if (key === DOM.Element) {\n    return this.element;\n  }\n\n  if (key === BoundViewFactory) {\n    if (this.boundViewFactory) {\n      return this.boundViewFactory;\n    }\n\n    let factory = this.instruction.viewFactory;\n    let partReplacements = this.partReplacements;\n\n    if (partReplacements) {\n      factory = partReplacements[factory.part] || factory;\n    }\n\n    this.boundViewFactory = new BoundViewFactory(this, factory, partReplacements);\n    return this.boundViewFactory;\n  }\n\n  if (key === ViewSlot) {\n    if (this.viewSlot === undefined) {\n      this.viewSlot = new ViewSlot(this.element, this.instruction.anchorIsContainer);\n      this.element.isContentProjectionSource = this.instruction.lifting;\n      this.children.push(this.viewSlot);\n    }\n\n    return this.viewSlot;\n  }\n\n  if (key === ViewResources) {\n    return this.viewResources;\n  }\n\n  if (key === TargetInstruction) {\n    return this.instruction;\n  }\n\n  return this.superGet(key);\n}\n\nconst createElementContainer = (\n  parent: Container,\n  element: Element,\n  instruction: TargetInstruction,\n  children: View[],\n  partReplacements: Record<string, any>,\n  resources: ViewResources\n): Container => {\n  const container = parent.createChild();\n  const provider = instruction.providers[0];\n\n  container.element = element as Element & { isContentProjectionSource: boolean };\n  container.instruction = instruction;\n  container.children = children;\n  container.viewResources = resources;\n  container.partReplacements = partReplacements;\n\n  container.registerSingleton(provider, provider);\n\n  container.superGet = container.get;\n  container.get = elementContainerGet;\n\n  return container;\n};\n","import { Container } from 'aurelia-dependency-injection';\nimport { HtmlBehaviorResource, ViewCompiler, ViewResources, ViewFactory } from 'aurelia-templating';\nimport { createWebComponentClassFromBehavior } from './custom-element-utilities';\nimport './interface';\nimport { ICustomElementInfo, ICustomHtmlRegistry } from './interface';\nimport { tagNameOf } from './utilities';\nimport { metadata } from 'aurelia-metadata';\n\nexport class CustomElementRegistry implements ICustomHtmlRegistry {\n\n  static inject = [Container, ViewCompiler, ViewResources];\n\n  /**\n   * Custom element name must have hyphen. With custom elements that do not have, prefix with `au-`\n   */\n  fallbackPrefix: string;\n\n  /**@internal */\n  private _lookup: Record<string, ICustomElementInfo>;\n\n  /**@internal */\n  private container: Container;\n\n  /**@internal */\n  private viewCompiler: ViewCompiler;\n\n  /**@internal */\n  private viewResources: ViewResources;\n\n  constructor(container: Container, viewCompiler: ViewCompiler, viewResources: ViewResources) {\n    this.fallbackPrefix = 'au-';\n    this._lookup = Object.create(null);\n    this.container = container;\n    this.viewCompiler = viewCompiler;\n    this.viewResources = viewResources;\n  }\n\n  /**\n   * Use all global elements from current view resources and define them as native custom element\n   */\n  useGlobalElements(): Function[] {\n    const viewResources = this.viewResources;\n    // store reference to all existing global resources\n    const elements = viewResources.elements;\n    // remove all global element resources\n    viewResources.elements = Object.create(null);\n\n    return Object.keys(elements).map(tagName => {\n      const behavior = elements[tagName];\n      return this.registerBehavior(behavior, tagName).classDefinition;\n    });\n  }\n\n  /**@internal */\n  registerBehavior(behavior: HtmlBehaviorResource, tagName?: string): ICustomElementInfo {\n    const classDefinition = createWebComponentClassFromBehavior(\n      this.container,\n      behavior,\n      this.viewResources,\n      this.viewCompiler\n    );\n    tagName = tagName || tagNameOf(behavior);\n\n    const info: ICustomElementInfo = this._lookup[tagName] = {\n      tagName: tagName,\n      behavior: behavior,\n      classDefinition: classDefinition\n    };\n\n    if (tagName.indexOf('-') === -1) {\n      tagName = this.fallbackPrefix + tagName;\n    }\n\n    customElements.define(tagName, classDefinition);\n\n    return info;\n  }\n\n  register(Type: Function): Promise<Function> {\n    let htmlBehaviorResource = metadata.get(metadata.resource, Type) as HtmlBehaviorResource;\n    // validating metadata\n    if (htmlBehaviorResource) {\n      ViewResources.convention(Type, htmlBehaviorResource);\n    } else {\n      htmlBehaviorResource = ViewResources.convention(Type) as HtmlBehaviorResource;\n    }\n    if (!(htmlBehaviorResource instanceof HtmlBehaviorResource) || htmlBehaviorResource.elementName === null) {\n      throw new Error(`class ${Type.name} is already associated with a different type of resource. Cannot register as a custom element.`);\n    }\n\n    const customElementInfo = this.registerBehavior(htmlBehaviorResource, Type['is']);\n    return htmlBehaviorResource\n      .load(this.container, Type)\n      .then(() => customElementInfo.classDefinition);\n  }\n\n  has(Type: Function): boolean {\n    let htmlBehaviorResource = metadata.get(metadata.resource, Type) as HtmlBehaviorResource;\n    if (!htmlBehaviorResource || !(htmlBehaviorResource instanceof HtmlBehaviorResource)) {\n      return false;\n    }\n    return this._lookup[tagNameOf(htmlBehaviorResource)] !== undefined;\n  }\n}\n"],"names":["BehaviorInstruction","TargetInstruction","DOM","BoundViewFactory","ViewSlot","ViewResources","metadata","HtmlBehaviorResource","Container","ViewCompiler"],"mappings":"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"}
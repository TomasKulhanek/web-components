{"version":3,"file":"aurelia-web-components.js","sources":["../../src/utilities.ts","../../src/custom-element-utilities.ts","../../src/custom-element-registry.ts"],"sourcesContent":["import { HtmlBehaviorResource } from 'aurelia-templating';\n\nexport const defineProperty = Reflect.defineProperty;\nexport const tagNameOf = (behavior: HtmlBehaviorResource) => behavior.elementName || behavior.target.name;\n\nconst sharedPropertyDescriptor = {\n  enumerable: false,\n  configurable: true,\n  get: undefined,\n  set: undefined\n} as PropertyDescriptor;\n\nexport const definePrototypeGetterSetter = <T extends object = object>(obj: T, propertyName: string, getter: () => any, setter: (val: any) => any): T => {\n  sharedPropertyDescriptor.get = getter;\n  sharedPropertyDescriptor.set = setter;\n  defineProperty(obj, propertyName, sharedPropertyDescriptor);\n  sharedPropertyDescriptor.get = sharedPropertyDescriptor.set = undefined;\n  return obj;\n};\n","import {\n  HtmlBehaviorResource,\n  BehaviorInstruction,\n  TargetInstruction,\n  ViewResources,\n  ViewSlot,\n  BoundViewFactory,\n  Controller,\n  View,\n  ViewCompiler\n} from 'aurelia-templating';\n\nimport {\n  Binding,\n  Scope,\n  InternalPropertyObserver\n} from 'aurelia-binding';\n\nimport {\n  Container\n} from 'aurelia-dependency-injection';\n\nimport {\n  DOM\n} from 'aurelia-pal';\n\nimport {\n  IGetterFunction\n} from './interface';\n\nimport {\n  definePrototypeGetterSetter,\n  defineProperty\n} from './utilities';\n\nconst emptyArray = Object.freeze([]) as any[];\n\nexport const createWebComponentClassFromBehavior = (\n  container: Container,\n  behavior: HtmlBehaviorResource,\n  viewResources: ViewResources,\n  compiler: ViewCompiler\n) => {\n\n  const CustomElementClass = class extends HTMLElement {\n\n    /**@internal */\n    _children: View[];\n    /**@internal */\n    _bindings: Binding[];\n    /**@internal */\n    au: { controller: Controller; };\n    /**@internal */\n    initialized: boolean;\n\n    constructor() {\n      super();\n      this.initialized = false;\n    }\n\n    auInit(): void {\n      if (this.initialized) {\n        return;\n      }\n\n      this.initialized = true;\n\n      const behaviorInstruction = BehaviorInstruction.element(this, behavior);\n      const attributes = this.attributes;\n      const children = this._children = [];\n      const bindings = this._bindings = [];\n\n      behavior.processAttributes(compiler, viewResources, this, attributes, behaviorInstruction);\n\n      for (let i = 0, ii = attributes.length; i < ii; ++i) {\n        const attr = attributes[i];\n        behaviorInstruction.attributes[attr.name] = attr.value;\n      }\n\n      behavior.compile(compiler, viewResources, this, behaviorInstruction, this.parentNode);\n\n      const targetInstruction = TargetInstruction.normal(\n        0,\n        0,\n        [behavior.target],\n        [behaviorInstruction],\n        /*no expression*/emptyArray,\n        behaviorInstruction\n      );\n\n      const childContainer = createElementContainer(\n        container,\n        this,\n        targetInstruction,\n        children,\n        behaviorInstruction.partReplacements,\n        viewResources\n      );\n\n      const controller = behavior.create(childContainer, behaviorInstruction, this, bindings);\n      controller.created(null);\n    }\n\n    connectedCallback(): void {\n      this.auInit();\n      let scope = { bindingContext: this, overrideContext: {} } as Scope;\n      this.au.controller.bind(scope);\n      this._bindings.forEach(x => x.bind(scope));\n      this._children.forEach(x => x.bind(scope.bindingContext, scope.overrideContext, true));\n\n      this.au.controller.attached();\n      this._children.forEach(x => x.attached());\n    }\n\n    disconnectedCallback(): void {\n      this.au.controller.detached();\n      this._children.forEach(x => x.detached());\n\n      this.au.controller.unbind();\n      this._bindings.forEach(x => x.unbind());\n      this._children.forEach(x => x.unbind());\n    }\n\n    attributeChangedCallback(attrName: string, oldValue: string, newValue: string): void {\n      this.auInit();\n      const bindable = behavior.attributes[attrName];\n      if (bindable !== undefined) {\n        this.au.controller.viewModel[bindable.name] = newValue;\n      }\n    }\n  };\n\n  const CustomElementViewModelClass = behavior.target;\n  const proto = CustomElementClass.prototype;\n  const observedAttributes: string[] = [];\n\n  behavior.properties.forEach(bindableProperty => {\n\n    const getterFn = function () {\n      return this.au.controller.viewModel[bindableProperty.name];\n    } as IGetterFunction;\n\n    getterFn.getObserver = function(obj: any) {\n      return getObserver(container, behavior, obj.au.controller.viewModel, bindableProperty.name);\n    };\n\n    definePrototypeGetterSetter(\n      proto,\n      bindableProperty.name,\n      getterFn,\n      function (value: unknown) {\n        this.au.controller.viewModel[bindableProperty.name] = value;\n      }\n    );\n\n    observedAttributes.push(bindableProperty.attribute);\n  });\n\n  defineProperty(CustomElementClass, 'observedAttributes', {\n    get: () => observedAttributes\n  });\n\n  // Object\n  //   .keys(CustomElementViewModelClass.prototype)\n  //   .forEach(key => {\n  //     const descriptor = Reflect.getOwnPropertyDescriptor(CustomElementViewModelClass.prototype, key);\n  //     if (typeof descriptor.value === 'function') {\n  //       proto[key] = function (...args: any[]) {\n  //         return this.au.controller.viewModel[key](...args);\n  //       };\n  //     }\n  //   });\n\n  return CustomElementClass;\n};\n\nconst getObserver = (\n  container: Container,\n  behavior: HtmlBehaviorResource,\n  instance: object & { __observers__: any; },\n  name: string\n): InternalPropertyObserver => {\n  let lookup = instance.__observers__;\n\n  if (lookup === undefined) {\n    if (!behavior.isInitialized) {\n      behavior.initialize(container, instance.constructor);\n    }\n\n    lookup = behavior.observerLocator.getOrCreateObserversLookup(instance);\n    behavior._ensurePropertiesDefined(instance, lookup);\n  }\n\n  return lookup[name];\n};\n\nfunction elementContainerGet(this: Container, key: any): any {\n  if (key === DOM.Element) {\n    return this.element;\n  }\n\n  if (key === BoundViewFactory) {\n    if (this.boundViewFactory) {\n      return this.boundViewFactory;\n    }\n\n    let factory = this.instruction.viewFactory;\n    let partReplacements = this.partReplacements;\n\n    if (partReplacements) {\n      factory = partReplacements[factory.part] || factory;\n    }\n\n    this.boundViewFactory = new BoundViewFactory(this, factory, partReplacements);\n    return this.boundViewFactory;\n  }\n\n  if (key === ViewSlot) {\n    if (this.viewSlot === undefined) {\n      this.viewSlot = new ViewSlot(this.element, this.instruction.anchorIsContainer);\n      this.element.isContentProjectionSource = this.instruction.lifting;\n      this.children.push(this.viewSlot);\n    }\n\n    return this.viewSlot;\n  }\n\n  if (key === ViewResources) {\n    return this.viewResources;\n  }\n\n  if (key === TargetInstruction) {\n    return this.instruction;\n  }\n\n  return this.superGet(key);\n}\n\nconst createElementContainer = (\n  parent: Container,\n  element: Element,\n  instruction: TargetInstruction,\n  children: View[],\n  partReplacements: Record<string, any>,\n  resources: ViewResources\n): Container => {\n  const container = parent.createChild();\n  const provider = instruction.providers[0];\n\n  container.element = element as Element & { isContentProjectionSource: boolean };\n  container.instruction = instruction;\n  container.children = children;\n  container.viewResources = resources;\n  container.partReplacements = partReplacements;\n\n  container.registerSingleton(provider, provider);\n\n  container.superGet = container.get;\n  container.get = elementContainerGet;\n\n  return container;\n};\n","import { Container } from 'aurelia-dependency-injection';\nimport { HtmlBehaviorResource, ViewCompiler, ViewResources, ViewFactory } from 'aurelia-templating';\nimport { createWebComponentClassFromBehavior } from './custom-element-utilities';\nimport './interface';\nimport { ICustomElementInfo, ICustomHtmlRegistry } from './interface';\nimport { tagNameOf } from './utilities';\nimport { metadata } from 'aurelia-metadata';\n\nexport class CustomElementRegistry implements ICustomHtmlRegistry {\n\n  static inject = [Container, ViewCompiler, ViewResources];\n\n  /**\n   * Custom element name must have hyphen. With custom elements that do not have, prefix with `au-`\n   */\n  fallbackPrefix: string;\n\n  /**@internal */\n  private _lookup: Record<string, ICustomElementInfo>;\n\n  /**@internal */\n  private container: Container;\n\n  /**@internal */\n  private viewCompiler: ViewCompiler;\n\n  /**@internal */\n  private viewResources: ViewResources;\n\n  constructor(container: Container, viewCompiler: ViewCompiler, viewResources: ViewResources) {\n    this.fallbackPrefix = 'au-';\n    this._lookup = Object.create(null);\n    this.container = container;\n    this.viewCompiler = viewCompiler;\n    this.viewResources = viewResources;\n  }\n\n  /**\n   * Use all global elements from current view resources and define them as native custom element\n   */\n  useGlobalElements(): Function[] {\n    const viewResources = this.viewResources;\n    // store reference to all existing global resources\n    const elements = viewResources.elements;\n    // remove all global element resources\n    viewResources.elements = Object.create(null);\n\n    return Object.keys(elements).map(tagName => {\n      const behavior = elements[tagName];\n      return this.registerBehavior(behavior, tagName).classDefinition;\n    });\n  }\n\n  /**@internal */\n  registerBehavior(behavior: HtmlBehaviorResource, tagName?: string): ICustomElementInfo {\n    const classDefinition = createWebComponentClassFromBehavior(\n      this.container,\n      behavior,\n      this.viewResources,\n      this.viewCompiler\n    );\n    tagName = tagName || tagNameOf(behavior);\n\n    const info: ICustomElementInfo = this._lookup[tagName] = {\n      tagName: tagName,\n      behavior: behavior,\n      classDefinition: classDefinition\n    };\n\n    if (tagName.indexOf('-') === -1) {\n      tagName = this.fallbackPrefix + tagName;\n    }\n\n    customElements.define(tagName, classDefinition);\n\n    return info;\n  }\n\n  register(Type: Function): Promise<Function> {\n    let htmlBehaviorResource = metadata.get(metadata.resource, Type) as HtmlBehaviorResource;\n    // validating metadata\n    if (htmlBehaviorResource) {\n      ViewResources.convention(Type, htmlBehaviorResource);\n    } else {\n      htmlBehaviorResource = ViewResources.convention(Type) as HtmlBehaviorResource;\n    }\n    if (!(htmlBehaviorResource instanceof HtmlBehaviorResource) || htmlBehaviorResource.elementName === null) {\n      throw new Error(`class ${Type.name} is already associated with a different type of resource. Cannot register as a custom element.`);\n    }\n\n    const customElementInfo = this.registerBehavior(htmlBehaviorResource, Type['is']);\n    return htmlBehaviorResource\n      .load(this.container, Type)\n      .then(() => customElementInfo.classDefinition);\n  }\n\n  has(Type: Function): boolean {\n    let htmlBehaviorResource = metadata.get(metadata.resource, Type) as HtmlBehaviorResource;\n    if (!htmlBehaviorResource || !(htmlBehaviorResource instanceof HtmlBehaviorResource)) {\n      return false;\n    }\n    return this._lookup[tagNameOf(htmlBehaviorResource)] !== undefined;\n  }\n}\n"],"names":[],"mappings":";;;;;AAEO,MAAM,cAAc,GAAG,OAAO,CAAC,cAAc,CAAC;AACrD,AAAO,MAAM,SAAS,GAAG,CAAC,QAA8B,KAAK,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC;AAE1G,MAAM,wBAAwB,GAAG;IAC/B,UAAU,EAAE,KAAK;IACjB,YAAY,EAAE,IAAI;IAClB,GAAG,EAAE,SAAS;IACd,GAAG,EAAE,SAAS;CACO,CAAC;AAExB,AAAO,MAAM,2BAA2B,GAAG,CAA4B,GAAM,EAAE,YAAoB,EAAE,MAAiB,EAAE,MAAyB;IAC/I,wBAAwB,CAAC,GAAG,GAAG,MAAM,CAAC;IACtC,wBAAwB,CAAC,GAAG,GAAG,MAAM,CAAC;IACtC,cAAc,CAAC,GAAG,EAAE,YAAY,EAAE,wBAAwB,CAAC,CAAC;IAC5D,wBAAwB,CAAC,GAAG,GAAG,wBAAwB,CAAC,GAAG,GAAG,SAAS,CAAC;IACxE,OAAO,GAAG,CAAC;CACZ,CAAC;;ACiBF,MAAM,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,CAAU,CAAC;AAE9C,AAAO,MAAM,mCAAmC,GAAG,CACjD,SAAoB,EACpB,QAA8B,EAC9B,aAA4B,EAC5B,QAAsB;IAGtB,MAAM,kBAAkB,GAAG,cAAc,WAAW;QAWlD;YACE,KAAK,EAAE,CAAC;YACR,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;SAC1B;QAED,MAAM;YACJ,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,OAAO;aACR;YAED,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YAExB,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YACxE,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;YACnC,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;YACrC,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;YAErC,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,EAAE,aAAa,EAAE,IAAI,EAAE,UAAU,EAAE,mBAAmB,CAAC,CAAC;YAE3F,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE;gBACnD,MAAM,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;gBAC3B,mBAAmB,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC;aACxD;YAED,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,aAAa,EAAE,IAAI,EAAE,mBAAmB,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YAEtF,MAAM,iBAAiB,GAAG,iBAAiB,CAAC,MAAM,CAChD,CAAC,EACD,CAAC,EACD,CAAC,QAAQ,CAAC,MAAM,CAAC,EACjB,CAAC,mBAAmB,CAAC,EACJ,UAAU,EAC3B,mBAAmB,CACpB,CAAC;YAEF,MAAM,cAAc,GAAG,sBAAsB,CAC3C,SAAS,EACT,IAAI,EACJ,iBAAiB,EACjB,QAAQ,EACR,mBAAmB,CAAC,gBAAgB,EACpC,aAAa,CACd,CAAC;YAEF,MAAM,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC,cAAc,EAAE,mBAAmB,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;YACxF,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC1B;QAED,iBAAiB;YACf,IAAI,CAAC,MAAM,EAAE,CAAC;YACd,IAAI,KAAK,GAAG,EAAE,cAAc,EAAE,IAAI,EAAE,eAAe,EAAE,EAAE,EAAW,CAAC;YACnE,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC/B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;YAC3C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC,CAAC;YAEvF,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;YAC9B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;SAC3C;QAED,oBAAoB;YAClB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;YAC9B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAE1C,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;YAC5B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;YACxC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;SACzC;QAED,wBAAwB,CAAC,QAAgB,EAAE,QAAgB,EAAE,QAAgB;YAC3E,IAAI,CAAC,MAAM,EAAE,CAAC;YACd,MAAM,QAAQ,GAAG,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YAC/C,IAAI,QAAQ,KAAK,SAAS,EAAE;gBAC1B,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;aACxD;SACF;KACF,CAAC;IAEF,MAAM,2BAA2B,GAAG,QAAQ,CAAC,MAAM,CAAC;IACpD,MAAM,KAAK,GAAG,kBAAkB,CAAC,SAAS,CAAC;IAC3C,MAAM,kBAAkB,GAAa,EAAE,CAAC;IAExC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,gBAAgB;QAE1C,MAAM,QAAQ,GAAG;YACf,OAAO,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;SACzC,CAAC;QAErB,QAAQ,CAAC,WAAW,GAAG,UAAS,GAAQ;YACtC,OAAO,WAAW,CAAC,SAAS,EAAE,QAAQ,EAAE,GAAG,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,EAAE,gBAAgB,CAAC,IAAI,CAAC,CAAC;SAC7F,CAAC;QAEF,2BAA2B,CACzB,KAAK,EACL,gBAAgB,CAAC,IAAI,EACrB,QAAQ,EACR,UAAU,KAAc;YACtB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;SAC7D,CACF,CAAC;QAEF,kBAAkB,CAAC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;KACrD,CAAC,CAAC;IAEH,cAAc,CAAC,kBAAkB,EAAE,oBAAoB,EAAE;QACvD,GAAG,EAAE,MAAM,kBAAkB;KAC9B,CAAC,CAAC;IAaH,OAAO,kBAAkB,CAAC;CAC3B,CAAC;AAEF,MAAM,WAAW,GAAG,CAClB,SAAoB,EACpB,QAA8B,EAC9B,QAA0C,EAC1C,IAAY;IAEZ,IAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC;IAEpC,IAAI,MAAM,KAAK,SAAS,EAAE;QACxB,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE;YAC3B,QAAQ,CAAC,UAAU,CAAC,SAAS,EAAE,QAAQ,CAAC,WAAW,CAAC,CAAC;SACtD;QAED,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,0BAA0B,CAAC,QAAQ,CAAC,CAAC;QACvE,QAAQ,CAAC,wBAAwB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;KACrD;IAED,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;CACrB,CAAC;AAEF,SAAS,mBAAmB,CAAkB,GAAQ;IACpD,IAAI,GAAG,KAAK,GAAG,CAAC,OAAO,EAAE;QACvB,OAAO,IAAI,CAAC,OAAO,CAAC;KACrB;IAED,IAAI,GAAG,KAAK,gBAAgB,EAAE;QAC5B,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACzB,OAAO,IAAI,CAAC,gBAAgB,CAAC;SAC9B;QAED,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC;QAC3C,IAAI,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAE7C,IAAI,gBAAgB,EAAE;YACpB,OAAO,GAAG,gBAAgB,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,OAAO,CAAC;SACrD;QAED,IAAI,CAAC,gBAAgB,GAAG,IAAI,gBAAgB,CAAC,IAAI,EAAE,OAAO,EAAE,gBAAgB,CAAC,CAAC;QAC9E,OAAO,IAAI,CAAC,gBAAgB,CAAC;KAC9B;IAED,IAAI,GAAG,KAAK,QAAQ,EAAE;QACpB,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;YAC/B,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;YAC/E,IAAI,CAAC,OAAO,CAAC,yBAAyB,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC;YAClE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACnC;QAED,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;IAED,IAAI,GAAG,KAAK,aAAa,EAAE;QACzB,OAAO,IAAI,CAAC,aAAa,CAAC;KAC3B;IAED,IAAI,GAAG,KAAK,iBAAiB,EAAE;QAC7B,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;IAED,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;CAC3B;AAED,MAAM,sBAAsB,GAAG,CAC7B,MAAiB,EACjB,OAAgB,EAChB,WAA8B,EAC9B,QAAgB,EAChB,gBAAqC,EACrC,SAAwB;IAExB,MAAM,SAAS,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC;IACvC,MAAM,QAAQ,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;IAE1C,SAAS,CAAC,OAAO,GAAG,OAA2D,CAAC;IAChF,SAAS,CAAC,WAAW,GAAG,WAAW,CAAC;IACpC,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC9B,SAAS,CAAC,aAAa,GAAG,SAAS,CAAC;IACpC,SAAS,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;IAE9C,SAAS,CAAC,iBAAiB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAEhD,SAAS,CAAC,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC;IACnC,SAAS,CAAC,GAAG,GAAG,mBAAmB,CAAC;IAEpC,OAAO,SAAS,CAAC;CAClB,CAAC;;MC7PW,qBAAqB;IAqBhC,YAAY,SAAoB,EAAE,YAA0B,EAAE,aAA4B;QACxF,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACnC,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QACjC,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;KACpC;IAKD,iBAAiB;QACf,MAAM,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QAEzC,MAAM,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;QAExC,aAAa,CAAC,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAE7C,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,OAAO;YACtC,MAAM,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;YACnC,OAAO,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,eAAe,CAAC;SACjE,CAAC,CAAC;KACJ;IAGD,gBAAgB,CAAC,QAA8B,EAAE,OAAgB;QAC/D,MAAM,eAAe,GAAG,mCAAmC,CACzD,IAAI,CAAC,SAAS,EACd,QAAQ,EACR,IAAI,CAAC,aAAa,EAClB,IAAI,CAAC,YAAY,CAClB,CAAC;QACF,OAAO,GAAG,OAAO,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC;QAEzC,MAAM,IAAI,GAAuB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG;YACvD,OAAO,EAAE,OAAO;YAChB,QAAQ,EAAE,QAAQ;YAClB,eAAe,EAAE,eAAe;SACjC,CAAC;QAEF,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;YAC/B,OAAO,GAAG,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;SACzC;QAED,cAAc,CAAC,MAAM,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;QAEhD,OAAO,IAAI,CAAC;KACb;IAED,QAAQ,CAAC,IAAc;QACrB,IAAI,oBAAoB,GAAG,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAyB,CAAC;QAEzF,IAAI,oBAAoB,EAAE;YACxB,aAAa,CAAC,UAAU,CAAC,IAAI,EAAE,oBAAoB,CAAC,CAAC;SACtD;aAAM;YACL,oBAAoB,GAAG,aAAa,CAAC,UAAU,CAAC,IAAI,CAAyB,CAAC;SAC/E;QACD,IAAI,EAAE,oBAAoB,YAAY,oBAAoB,CAAC,IAAI,oBAAoB,CAAC,WAAW,KAAK,IAAI,EAAE;YACxG,MAAM,IAAI,KAAK,CAAC,SAAS,IAAI,CAAC,IAAI,gGAAgG,CAAC,CAAC;SACrI;QAED,MAAM,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,oBAAoB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAClF,OAAO,oBAAoB;aACxB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC;aAC1B,IAAI,CAAC,MAAM,iBAAiB,CAAC,eAAe,CAAC,CAAC;KAClD;IAED,GAAG,CAAC,IAAc;QAChB,IAAI,oBAAoB,GAAG,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAyB,CAAC;QACzF,IAAI,CAAC,oBAAoB,IAAI,EAAE,oBAAoB,YAAY,oBAAoB,CAAC,EAAE;YACpF,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,oBAAoB,CAAC,CAAC,KAAK,SAAS,CAAC;KACpE;;AA5FM,4BAAM,GAAG,CAAC,SAAS,EAAE,YAAY,EAAE,aAAa,CAAC,CAAC;;;;"}